# Проект: Система сбора и мониторинга метрик

## Описание проекта
Этот проект реализует сервер и агента для сбора и мониторинга метрик через HTTP API. В качестве хранилища метрик используется база данных PostgreSQL. Основной задачей является создание системы, которая позволяет централизованно собирать метрики с различных сервисов, хранить их и делать доступными для анализа.

## Мотивация
Мониторинг метрик важен для понимания состояния системы в реальном времени и для принятия управленческих решений на основе этих данных. Проект предоставляет гибкую и масштабируемую архитектуру для сбора, хранения и доступа к метрикам, что позволяет эффективно мониторить производительность сервисов, отслеживать изменения, а также выявлять потенциальные проблемы.

---

## Конфигурация сервера

### Конфигурация через переменные окружения

| Переменная         | Описание                                      | Пример значения                                      |
|--------------------|-----------------------------------------------|------------------------------------------------------|
| `DATABASE_DSN`      | Строка подключения к базе данных PostgreSQL   | `postgres://postgres:root@db:5432/metrics`           |
| `FILE_STORAGE_PATH` | Путь к файлу для хранения метрик              | `/path/to/storage.txt`                               |
| `RESTORE`           | Включение восстановления метрик при старте    | `true`                                               |
| `ADDRESS`           | Адрес сервера                                | `localhost:8080`                                     |
| `STORE_INTERVAL`    | Интервал сохранения метрик в файл             | `5`                                                  |
| `LOG_LEVEL`         | Уровень логирования                           | `error`                                              |
| `KEY`               | API ключ для хеширования                     | `someapikey`                                         |

### Пример `.env` файла
```env
DATABASE_DSN="postgres://postgres:root@db:5432/metrics"
FILE_STORAGE_PATH=/path/to/storage.txt
RESTORE=true
ADDRESS="localhost:8080"
STORE_INTERVAL=10
LOG_LEVEL="error"
KEY="someapikey"
```

### Конфигурация через флаги

| Флаг  | Описание                                      | Значение по умолчанию         |
|-------|-----------------------------------------------|-------------------------------|
| `-a`  | Адрес и порт сервера                          | `localhost:8080`              |
| `-i`  | Интервал для сохранения метрик в файл         | `5`                           |
| `-r`  | Восстановление метрик из файла при старте     | `false`                       |
| `-f`  | Путь к файлу хранения метрик                  | Пусто                         |
| `-d`  | Строка подключения к базе данных (DSN)        | Пусто                         |
| `-k`  | API ключ для хеширования запросов             | Пусто                         |

## Конфигурация агента

Агент собирает метрики с клиента и отправляет их на сервер с определенной периодичностью.

### Конфигурация через переменные окружения

| Переменная       | Описание                                | Пример значения         |
|------------------|-----------------------------------------|-------------------------|
| `ADDRESS`        | Адрес сервера                           | `localhost:8080`         |
| `POLL_INTERVAL`  | Интервал сбора метрик                   | `2` (в секундах)         |
| `REPORT_INTERVAL`| Интервал отправки метрик на сервер      | `10` (в секундах)        |
| `KEY`            | API ключ для хеширования               | `your-api-key`           |